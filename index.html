<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <title>Solfeggio FrequenciesÔºãSchumann Resonance</title>
    <meta name="robots" content="noindex">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            padding: 20px;
            user-select: none;
            margin: 0;
        }

        h2 {
            font-size: clamp(1.2rem, 2.5vw, 1.8rem);
            text-align: center;
        }

        label,
        select,
        input,
        button {
            margin-top: 10px;
            display: block;
            font-size: 1rem;
        }

        button {
            margin-top: 10px;
            padding: 10px 20px;
            font-size: clamp(0.9rem, 2vw, 1rem);
            border-radius: 6px;
            border: none;
            background-color: #2c3e50;
            color: #fff;
            cursor: pointer;
        }

        button:hover {
            background-color: #34495e;
        }

        canvas {
            border: 1px solid #ccc;
            background-color: #1a1a1a;
            margin-top: 20px;
            cursor: crosshair;
            width: 100%;
            max-width: 100%;
            height: auto;
            display: block;
        }

        #info {
            margin-top: 10px;
            font-size: clamp(0.8rem, 2vw, 1rem);
        }

        #visitorCount {
            margin-top: 20px;
            font-size: clamp(1rem, 2.5vw, 1.2rem);
            color: #2c3e50;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            label {
                font-size: 0.9rem;
            }
            select,
            input[type="range"] {
                width: 100%;
                font-size: 1rem;
            }
            button {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <h2>üéß Solfeggio FrequenciesÔºãSchumann Resonance</h2>

    <label>Solfeggio FrequenciesÔºàHzÔºâÔºö
    <select id="mainFreq">
      <option value="396">396 Hz</option>
      <option value="417">417 Hz</option>
      <option value="417">432 Hz</option>  
      <option value="528" selected>528 Hz</option>
      <option value="639">639 Hz</option>
      <option value="741">741 Hz</option>
      <option value="852">852 Hz</option>
      <option value="963">963 Hz</option>
    </select>
  </label>

    <label>Schumann ResonanceÔºàHzÔºâÔºö
    <select id="modFreq">
      <option value="7.83" selected>7.83 Hz</option>
      <option value="10">10 Hz</option>
    </select>
  </label>

    <label>VolumeÔºö
    <input type="range" id="volume" min="0" max="1" step="0.01" value="0.5">
  </label>

    <button onclick="startAudio()">Play</button>
    <button onclick="stopAudio()">Stop</button>

    <canvas id="oscilloscope"></canvas>
    <div id="info">Frequency: -- Hz, Amplitude: --%</div>
    <h3>Please adjust the volume appropriately to avoid prolonged use that may affect your health.</h3>
    <div id="visitorCount"></div>

    <script>
        document.addEventListener('contextmenu', e => e.preventDefault());

        let audioCtx, mainOsc, modOsc, modGain, gainNode, analyser, frequencyData, animationId;
        const canvas = document.getElementById("oscilloscope");
        const info = document.getElementById("info");
        let canvasCtx = canvas.getContext("2d");

        // üîπ canvas RWD
        function resizeCanvas() {
            canvas.width = canvas.clientWidth;
            canvas.height = Math.max(200, canvas.clientWidth * 0.4);
            canvasCtx = canvas.getContext("2d");
        }
        window.addEventListener("resize", resizeCanvas);
        window.addEventListener("load", resizeCanvas);

        // üîπ Ë®™ÂÆ¢Ë®àÊï∏
        function updateVisitorCount() {
            const deviceFingerprint = navigator.userAgent;
            let count = localStorage.getItem('visitorCount') || 0;
            const lastVisit = localStorage.getItem('lastVisit_' + deviceFingerprint);
            const now = Date.now();
            if (!lastVisit || (now - parseInt(lastVisit) > 86400000)) {
                count = parseInt(count) + 1;
                localStorage.setItem('visitorCount', count);
                localStorage.setItem('lastVisit_' + deviceFingerprint, now);
            }
            document.getElementById("visitorCount").textContent = `VisitÔºö${count} ‰∫∫`;
        }
        window.addEventListener('load', updateVisitorCount);

        // üîπ ÂïüÂãïÈü≥È†ª
        function startAudio() {
            stopAudio();
            try {
                audioCtx = new(window.AudioContext || window.webkitAudioContext)();
                const freq = parseFloat(document.getElementById("mainFreq").value);
                const modFreq = parseFloat(document.getElementById("modFreq").value);
                const volume = parseFloat(document.getElementById("volume").value);

                mainOsc = audioCtx.createOscillator();
                mainOsc.type = "sine";
                mainOsc.frequency.value = freq;

                modOsc = audioCtx.createOscillator();
                modOsc.type = "sine";
                modOsc.frequency.value = modFreq;

                modGain = audioCtx.createGain();
                modGain.gain.value = 10;

                modOsc.connect(modGain);
                modGain.connect(mainOsc.frequency);

                gainNode = audioCtx.createGain();
                gainNode.gain.value = volume;

                analyser = audioCtx.createAnalyser();
                analyser.fftSize = 4096;
                const bufferLength = analyser.frequencyBinCount;
                frequencyData = new Uint8Array(bufferLength);

                mainOsc.connect(gainNode);
                gainNode.connect(analyser);
                analyser.connect(audioCtx.destination);

                mainOsc.start();
                modOsc.start();

                function draw() {
                    animationId = requestAnimationFrame(draw);
                    analyser.getByteFrequencyData(frequencyData);

                    canvasCtx.fillStyle = "#1a1a1a";
                    canvasCtx.fillRect(0, 0, canvas.width, canvas.height);

                    const sampleRate = audioCtx.sampleRate;
                    const freqPerBin = sampleRate / analyser.fftSize;
                    const maxFreq = 1500;
                    const binsToDisplay = Math.min(Math.floor(maxFreq / freqPerBin), bufferLength);

                    canvasCtx.beginPath();
                    for (let i = 0; i < binsToDisplay; i++) {
                        const baseAmplitude = frequencyData[i] / 255;
                        const adjustedAmplitude = baseAmplitude * volume;
                        const x = (i / binsToDisplay) * canvas.width;
                        const y = canvas.height - (adjustedAmplitude * canvas.height);

                        const hue = (i / binsToDisplay) * 360;
                        const lightness = 30 + (adjustedAmplitude * 60);
                        canvasCtx.strokeStyle = `hsl(${hue}, 70%, ${lightness}%)`;

                        if (i === 0) canvasCtx.moveTo(x, y);
                        else canvasCtx.lineTo(x, y);
                    }
                    canvasCtx.lineWidth = 2;
                    canvasCtx.stroke();

                    canvasCtx.fillStyle = "#fff";
                    canvasCtx.font = "12px Arial";
                    canvasCtx.textAlign = "center";

                    // x Ëª∏
                    canvasCtx.beginPath();
                    canvasCtx.strokeStyle = "#ccc";
                    canvasCtx.moveTo(0, canvas.height - 10);
                    canvasCtx.lineTo(canvas.width, canvas.height - 10);
                    canvasCtx.stroke();
                    const freqLabels = [0, 250, 500, 750, 1000, 1250, 1500];
                    freqLabels.forEach(freq => {
                        const x = (freq / maxFreq) * canvas.width;
                        canvasCtx.moveTo(x, canvas.height - 10);
                        canvasCtx.lineTo(x, canvas.height - 5);
                        canvasCtx.fillText(`${freq} Hz`, x, canvas.height);
                    });

                    // y Ëª∏
                    canvasCtx.beginPath();
                    canvasCtx.moveTo(10, 0);
                    canvasCtx.lineTo(10, canvas.height);
                    canvasCtx.stroke();
                    const ampLabels = [0, 25, 50, 75, 100];
                    ampLabels.forEach(amp => {
                        const y = canvas.height - (amp / 100) * canvas.height;
                        canvasCtx.moveTo(5, y);
                        canvasCtx.lineTo(10, y);
                        canvasCtx.fillText(`${amp}%`, 0, y + 5);
                    });

                    // ÊªëÈº†Ë≥áË®ä
                    canvas.addEventListener("mousemove", function(event) {
                        const rect = canvas.getBoundingClientRect();
                        const x = event.clientX - rect.left;
                        const freqIndex = Math.floor((x / canvas.width) * binsToDisplay);
                        const frequency = freqIndex * freqPerBin;
                        const baseAmplitude = frequencyData[freqIndex] / 255;
                        const adjustedAmplitude = baseAmplitude * volume;
                        info.innerText = `Frequency: ${frequency.toFixed(2)} Hz, Amplitude: ${(adjustedAmplitude * 100).toFixed(2)}%`;
                    }, {
                        passive: true
                    });
                }
                draw();
            } catch (e) {
                console.error("Audio error:", e);
                alert("Audio initialization failed, please ensure browser supports Web Audio API.");
            }
        }

        // üîπ ÂÅúÊ≠¢Èü≥È†ª
        function stopAudio() {
            if (mainOsc) mainOsc.stop();
            if (modOsc) modOsc.stop();
            if (animationId) cancelAnimationFrame(animationId);
            if (audioCtx) audioCtx.close();
            mainOsc = null;
            modOsc = null;
        }
    </script>
</body>

</html>
